<?xml version="1.0" encoding="utf-8"?>
<CoverageReport scope="Chronicis.Api.Services.ExternalLinks.SpellCategoryStrategy">
  <Summary>
    <Class>Chronicis.Api.Services.ExternalLinks.SpellCategoryStrategy</Class>
    <Assembly>Chronicis.Api</Assembly>
    <Files>
      <File>Z:\repos\chronicis\src\Chronicis.Api\Services\ExternalLinks\SpellCategoryStrategy.cs</File>
    </Files>
    <Coveredlines>83</Coveredlines>
    <Uncoveredlines>0</Uncoveredlines>
    <Coverablelines>83</Coverablelines>
    <Totallines>113</Totallines>
    <Linecoverage>100</Linecoverage>
    <Coveredbranches>38</Coveredbranches>
    <Totalbranches>38</Totalbranches>
    <Branchcoverage>100</Branchcoverage>
    <Coveredmethods>11</Coveredmethods>
    <Fullcoveredmethods>11</Fullcoveredmethods>
    <Totalmethods>11</Totalmethods>
    <Methodcoverage>100</Methodcoverage>
    <Fullmethodcoverage>100</Fullmethodcoverage>
  </Summary>
  <Metrics>
    <Element name="get_CategoryKey">
      <CrapScore>1</CrapScore>
      <Cyclomaticcomplexity>1</Cyclomaticcomplexity>
      <Linecoverage>100</Linecoverage>
      <Branchcoverage>100</Branchcoverage>
    </Element>
    <Element name="get_Endpoint">
      <CrapScore>1</CrapScore>
      <Cyclomaticcomplexity>1</Cyclomaticcomplexity>
      <Linecoverage>100</Linecoverage>
      <Branchcoverage>100</Branchcoverage>
    </Element>
    <Element name="get_DisplayName">
      <CrapScore>1</CrapScore>
      <Cyclomaticcomplexity>1</Cyclomaticcomplexity>
      <Linecoverage>100</Linecoverage>
      <Branchcoverage>100</Branchcoverage>
    </Element>
    <Element name="get_Icon">
      <CrapScore>1</CrapScore>
      <Cyclomaticcomplexity>1</Cyclomaticcomplexity>
      <Linecoverage>100</Linecoverage>
      <Branchcoverage>100</Branchcoverage>
    </Element>
    <Element name="BuildMarkdown">
      <CrapScore>1</CrapScore>
      <Cyclomaticcomplexity>1</Cyclomaticcomplexity>
      <Linecoverage>100</Linecoverage>
      <Branchcoverage>100</Branchcoverage>
    </Element>
    <Element name="BuildSubtitle">
      <CrapScore>6</CrapScore>
      <Cyclomaticcomplexity>6</Cyclomaticcomplexity>
      <Linecoverage>100</Linecoverage>
      <Branchcoverage>100</Branchcoverage>
    </Element>
    <Element name="AppendLevelAndSchool">
      <CrapScore>4</CrapScore>
      <Cyclomaticcomplexity>4</Cyclomaticcomplexity>
      <Linecoverage>100</Linecoverage>
      <Branchcoverage>100</Branchcoverage>
    </Element>
    <Element name="AppendCastingInfo">
      <CrapScore>14</CrapScore>
      <Cyclomaticcomplexity>14</Cyclomaticcomplexity>
      <Linecoverage>100</Linecoverage>
      <Branchcoverage>100</Branchcoverage>
    </Element>
    <Element name="AppendComponents">
      <CrapScore>10</CrapScore>
      <Cyclomaticcomplexity>10</Cyclomaticcomplexity>
      <Linecoverage>100</Linecoverage>
      <Branchcoverage>100</Branchcoverage>
    </Element>
    <Element name="AppendDescription">
      <CrapScore>2</CrapScore>
      <Cyclomaticcomplexity>2</Cyclomaticcomplexity>
      <Linecoverage>100</Linecoverage>
      <Branchcoverage>100</Branchcoverage>
    </Element>
    <Element name="AppendHigherLevels">
      <CrapScore>2</CrapScore>
      <Cyclomaticcomplexity>2</Cyclomaticcomplexity>
      <Linecoverage>100</Linecoverage>
      <Branchcoverage>100</Branchcoverage>
    </Element>
  </Metrics>
  <Files>
    <File name="Z:\repos\chronicis\src\Chronicis.Api\Services\ExternalLinks\SpellCategoryStrategy.cs">
      <LineAnalysis line="1" visits="-1" coverage="NotCoverable" coveredbranches="" totalbranches="" content="using System.Text;" />
      <LineAnalysis line="2" visits="-1" coverage="NotCoverable" coveredbranches="" totalbranches="" content="using System.Text.Json;" />
      <LineAnalysis line="3" visits="-1" coverage="NotCoverable" coveredbranches="" totalbranches="" content="using static Chronicis.Api.Services.ExternalLinks.Open5eJsonHelpers;" />
      <LineAnalysis line="4" visits="-1" coverage="NotCoverable" coveredbranches="" totalbranches="" content="" />
      <LineAnalysis line="5" visits="-1" coverage="NotCoverable" coveredbranches="" totalbranches="" content="namespace Chronicis.Api.Services.ExternalLinks;" />
      <LineAnalysis line="6" visits="-1" coverage="NotCoverable" coveredbranches="" totalbranches="" content="" />
      <LineAnalysis line="7" visits="-1" coverage="NotCoverable" coveredbranches="" totalbranches="" content="public sealed class SpellCategoryStrategy : Open5eCategoryStrategyBase" />
      <LineAnalysis line="8" visits="-1" coverage="NotCoverable" coveredbranches="" totalbranches="" content="{" />
      <LineAnalysis line="9" visits="112" coverage="Covered" coveredbranches="" totalbranches="" content="    public override string CategoryKey =&gt; &quot;spells&quot;;" />
      <LineAnalysis line="10" visits="12" coverage="Covered" coveredbranches="" totalbranches="" content="    public override string Endpoint =&gt; &quot;spells&quot;;" />
      <LineAnalysis line="11" visits="41" coverage="Covered" coveredbranches="" totalbranches="" content="    public override string DisplayName =&gt; &quot;Spell&quot;;" />
      <LineAnalysis line="12" visits="3" coverage="Covered" coveredbranches="" totalbranches="" content="    public override string? Icon =&gt; &quot;✨&quot;;" />
      <LineAnalysis line="13" visits="-1" coverage="NotCoverable" coveredbranches="" totalbranches="" content="" />
      <LineAnalysis line="14" visits="-1" coverage="NotCoverable" coveredbranches="" totalbranches="" content="    public override string BuildMarkdown(JsonElement root, string title)" />
      <LineAnalysis line="15" visits="9" coverage="Covered" coveredbranches="" totalbranches="" content="    {" />
      <LineAnalysis line="16" visits="9" coverage="Covered" coveredbranches="" totalbranches="" content="        var sb = new StringBuilder();" />
      <LineAnalysis line="17" visits="9" coverage="Covered" coveredbranches="" totalbranches="" content="        sb.AppendLine($&quot;# {title}&quot;);" />
      <LineAnalysis line="18" visits="9" coverage="Covered" coveredbranches="" totalbranches="" content="        sb.AppendLine();" />
      <LineAnalysis line="19" visits="-1" coverage="NotCoverable" coveredbranches="" totalbranches="" content="" />
      <LineAnalysis line="20" visits="9" coverage="Covered" coveredbranches="" totalbranches="" content="        AppendLevelAndSchool(sb, root);" />
      <LineAnalysis line="21" visits="9" coverage="Covered" coveredbranches="" totalbranches="" content="        AppendCastingInfo(sb, root);" />
      <LineAnalysis line="22" visits="9" coverage="Covered" coveredbranches="" totalbranches="" content="        AppendComponents(sb, root);" />
      <LineAnalysis line="23" visits="9" coverage="Covered" coveredbranches="" totalbranches="" content="        sb.AppendLine();" />
      <LineAnalysis line="24" visits="9" coverage="Covered" coveredbranches="" totalbranches="" content="        AppendDescription(sb, root);" />
      <LineAnalysis line="25" visits="9" coverage="Covered" coveredbranches="" totalbranches="" content="        AppendHigherLevels(sb, root);" />
      <LineAnalysis line="26" visits="-1" coverage="NotCoverable" coveredbranches="" totalbranches="" content="" />
      <LineAnalysis line="27" visits="9" coverage="Covered" coveredbranches="" totalbranches="" content="        return sb.ToString().Trim();" />
      <LineAnalysis line="28" visits="9" coverage="Covered" coveredbranches="" totalbranches="" content="    }" />
      <LineAnalysis line="29" visits="-1" coverage="NotCoverable" coveredbranches="" totalbranches="" content="" />
      <LineAnalysis line="30" visits="-1" coverage="NotCoverable" coveredbranches="" totalbranches="" content="    public override string BuildSubtitle(JsonElement item)" />
      <LineAnalysis line="31" visits="34" coverage="Covered" coveredbranches="" totalbranches="" content="    {" />
      <LineAnalysis line="32" visits="34" coverage="Covered" coveredbranches="" totalbranches="" content="        var parts = new List&lt;string&gt; { DisplayName };" />
      <LineAnalysis line="33" visits="-1" coverage="NotCoverable" coveredbranches="" totalbranches="" content="" />
      <LineAnalysis line="34" visits="34" coverage="Covered" coveredbranches="" totalbranches="" content="        var level = GetInt(item, &quot;level&quot;);" />
      <LineAnalysis line="35" visits="34" coverage="Covered" coveredbranches="" totalbranches="" content="        var school = GetStringFromObject(item, &quot;school&quot;, &quot;name&quot;);" />
      <LineAnalysis line="36" visits="34" coverage="Covered" coveredbranches="2" totalbranches="2" content="        if (level.HasValue)" />
      <LineAnalysis line="37" visits="33" coverage="Covered" coveredbranches="" totalbranches="" content="        {" />
      <LineAnalysis line="38" visits="33" coverage="Covered" coveredbranches="2" totalbranches="2" content="            parts.Add(level == 0 ? &quot;Cantrip&quot; : $&quot;Level {level}&quot;);" />
      <LineAnalysis line="39" visits="33" coverage="Covered" coveredbranches="" totalbranches="" content="        }" />
      <LineAnalysis line="40" visits="34" coverage="Covered" coveredbranches="2" totalbranches="2" content="        if (!string.IsNullOrEmpty(school))" />
      <LineAnalysis line="41" visits="32" coverage="Covered" coveredbranches="" totalbranches="" content="        {" />
      <LineAnalysis line="42" visits="32" coverage="Covered" coveredbranches="" totalbranches="" content="            parts.Add(school);" />
      <LineAnalysis line="43" visits="32" coverage="Covered" coveredbranches="" totalbranches="" content="        }" />
      <LineAnalysis line="44" visits="-1" coverage="NotCoverable" coveredbranches="" totalbranches="" content="" />
      <LineAnalysis line="45" visits="34" coverage="Covered" coveredbranches="" totalbranches="" content="        return string.Join(&quot; • &quot;, parts);" />
      <LineAnalysis line="46" visits="34" coverage="Covered" coveredbranches="" totalbranches="" content="    }" />
      <LineAnalysis line="47" visits="-1" coverage="NotCoverable" coveredbranches="" totalbranches="" content="" />
      <LineAnalysis line="48" visits="-1" coverage="NotCoverable" coveredbranches="" totalbranches="" content="    private static void AppendLevelAndSchool(StringBuilder sb, JsonElement root)" />
      <LineAnalysis line="49" visits="9" coverage="Covered" coveredbranches="" totalbranches="" content="    {" />
      <LineAnalysis line="50" visits="9" coverage="Covered" coveredbranches="" totalbranches="" content="        var level = GetInt(root, &quot;level&quot;);" />
      <LineAnalysis line="51" visits="9" coverage="Covered" coveredbranches="" totalbranches="" content="        var school = GetStringFromObject(root, &quot;school&quot;, &quot;name&quot;);" />
      <LineAnalysis line="52" visits="9" coverage="Covered" coveredbranches="2" totalbranches="2" content="        var levelText = level == 0 ? &quot;Cantrip&quot; : $&quot;Level {level}&quot;;" />
      <LineAnalysis line="53" visits="-1" coverage="NotCoverable" coveredbranches="" totalbranches="" content="" />
      <LineAnalysis line="54" visits="9" coverage="Covered" coveredbranches="2" totalbranches="2" content="        sb.AppendLine(!string.IsNullOrEmpty(school) ? $&quot;*{levelText} {school}*&quot; : $&quot;*{levelText}*&quot;);" />
      <LineAnalysis line="55" visits="9" coverage="Covered" coveredbranches="" totalbranches="" content="        sb.AppendLine();" />
      <LineAnalysis line="56" visits="9" coverage="Covered" coveredbranches="" totalbranches="" content="    }" />
      <LineAnalysis line="57" visits="-1" coverage="NotCoverable" coveredbranches="" totalbranches="" content="" />
      <LineAnalysis line="58" visits="-1" coverage="NotCoverable" coveredbranches="" totalbranches="" content="    private static void AppendCastingInfo(StringBuilder sb, JsonElement root)" />
      <LineAnalysis line="59" visits="9" coverage="Covered" coveredbranches="" totalbranches="" content="    {" />
      <LineAnalysis line="60" visits="9" coverage="Covered" coveredbranches="" totalbranches="" content="        var castingTime = GetString(root, &quot;casting_time&quot;);" />
      <LineAnalysis line="61" visits="9" coverage="Covered" coveredbranches="4" totalbranches="4" content="        var range = GetString(root, &quot;range_text&quot;) ?? GetString(root, &quot;range&quot;)?.ToString();" />
      <LineAnalysis line="62" visits="9" coverage="Covered" coveredbranches="" totalbranches="" content="        var duration = GetString(root, &quot;duration&quot;);" />
      <LineAnalysis line="63" visits="9" coverage="Covered" coveredbranches="" totalbranches="" content="        var concentration = GetBool(root, &quot;concentration&quot;);" />
      <LineAnalysis line="64" visits="9" coverage="Covered" coveredbranches="" totalbranches="" content="        var ritual = GetBool(root, &quot;ritual&quot;);" />
      <LineAnalysis line="65" visits="-1" coverage="NotCoverable" coveredbranches="" totalbranches="" content="" />
      <LineAnalysis line="66" visits="9" coverage="Covered" coveredbranches="" totalbranches="" content="        sb.AppendLine(&quot;## Casting&quot;);" />
      <LineAnalysis line="67" visits="9" coverage="Covered" coveredbranches="2" totalbranches="2" content="        if (!string.IsNullOrEmpty(castingTime))" />
      <LineAnalysis line="68" visits="3" coverage="Covered" coveredbranches="2" totalbranches="2" content="            sb.AppendLine($&quot;- **Casting Time:** {castingTime}{(ritual == true ? &quot; (ritual)&quot; : &quot;&quot;)}&quot;);" />
      <LineAnalysis line="69" visits="9" coverage="Covered" coveredbranches="2" totalbranches="2" content="        if (!string.IsNullOrEmpty(range))" />
      <LineAnalysis line="70" visits="3" coverage="Covered" coveredbranches="" totalbranches="" content="            sb.AppendLine($&quot;- **Range:** {range}&quot;);" />
      <LineAnalysis line="71" visits="9" coverage="Covered" coveredbranches="2" totalbranches="2" content="        if (!string.IsNullOrEmpty(duration))" />
      <LineAnalysis line="72" visits="3" coverage="Covered" coveredbranches="2" totalbranches="2" content="            sb.AppendLine($&quot;- **Duration:** {(concentration == true ? &quot;Concentration, &quot; : &quot;&quot;)}{duration}&quot;);" />
      <LineAnalysis line="73" visits="9" coverage="Covered" coveredbranches="" totalbranches="" content="    }" />
      <LineAnalysis line="74" visits="-1" coverage="NotCoverable" coveredbranches="" totalbranches="" content="" />
      <LineAnalysis line="75" visits="-1" coverage="NotCoverable" coveredbranches="" totalbranches="" content="    private static void AppendComponents(StringBuilder sb, JsonElement root)" />
      <LineAnalysis line="76" visits="9" coverage="Covered" coveredbranches="" totalbranches="" content="    {" />
      <LineAnalysis line="77" visits="9" coverage="Covered" coveredbranches="" totalbranches="" content="        var verbal = GetBool(root, &quot;verbal&quot;);" />
      <LineAnalysis line="78" visits="9" coverage="Covered" coveredbranches="" totalbranches="" content="        var somatic = GetBool(root, &quot;somatic&quot;);" />
      <LineAnalysis line="79" visits="9" coverage="Covered" coveredbranches="" totalbranches="" content="        var material = GetBool(root, &quot;material&quot;);" />
      <LineAnalysis line="80" visits="9" coverage="Covered" coveredbranches="" totalbranches="" content="        var materialDesc = GetString(root, &quot;material_specified&quot;);" />
      <LineAnalysis line="81" visits="-1" coverage="NotCoverable" coveredbranches="" totalbranches="" content="" />
      <LineAnalysis line="82" visits="9" coverage="Covered" coveredbranches="" totalbranches="" content="        var components = new List&lt;string&gt;();" />
      <LineAnalysis line="83" visits="9" coverage="Covered" coveredbranches="2" totalbranches="2" content="        if (verbal == true)" />
      <LineAnalysis line="84" visits="1" coverage="Covered" coveredbranches="" totalbranches="" content="            components.Add(&quot;V&quot;);" />
      <LineAnalysis line="85" visits="9" coverage="Covered" coveredbranches="2" totalbranches="2" content="        if (somatic == true)" />
      <LineAnalysis line="86" visits="1" coverage="Covered" coveredbranches="" totalbranches="" content="            components.Add(&quot;S&quot;);" />
      <LineAnalysis line="87" visits="9" coverage="Covered" coveredbranches="2" totalbranches="2" content="        if (material == true)" />
      <LineAnalysis line="88" visits="2" coverage="Covered" coveredbranches="2" totalbranches="2" content="            components.Add($&quot;M{(!string.IsNullOrEmpty(materialDesc) ? $&quot; ({materialDesc})&quot; : &quot;&quot;)}&quot;);" />
      <LineAnalysis line="89" visits="9" coverage="Covered" coveredbranches="2" totalbranches="2" content="        if (components.Count &gt; 0)" />
      <LineAnalysis line="90" visits="2" coverage="Covered" coveredbranches="" totalbranches="" content="            sb.AppendLine($&quot;- **Components:** {string.Join(&quot;, &quot;, components)}&quot;);" />
      <LineAnalysis line="91" visits="9" coverage="Covered" coveredbranches="" totalbranches="" content="    }" />
      <LineAnalysis line="92" visits="-1" coverage="NotCoverable" coveredbranches="" totalbranches="" content="" />
      <LineAnalysis line="93" visits="-1" coverage="NotCoverable" coveredbranches="" totalbranches="" content="    private static void AppendDescription(StringBuilder sb, JsonElement root)" />
      <LineAnalysis line="94" visits="9" coverage="Covered" coveredbranches="" totalbranches="" content="    {" />
      <LineAnalysis line="95" visits="9" coverage="Covered" coveredbranches="" totalbranches="" content="        var desc = GetString(root, &quot;desc&quot;);" />
      <LineAnalysis line="96" visits="9" coverage="Covered" coveredbranches="2" totalbranches="2" content="        if (!string.IsNullOrEmpty(desc))" />
      <LineAnalysis line="97" visits="5" coverage="Covered" coveredbranches="" totalbranches="" content="        {" />
      <LineAnalysis line="98" visits="5" coverage="Covered" coveredbranches="" totalbranches="" content="            sb.AppendLine(&quot;## Description&quot;);" />
      <LineAnalysis line="99" visits="5" coverage="Covered" coveredbranches="" totalbranches="" content="            sb.AppendLine(desc);" />
      <LineAnalysis line="100" visits="5" coverage="Covered" coveredbranches="" totalbranches="" content="            sb.AppendLine();" />
      <LineAnalysis line="101" visits="5" coverage="Covered" coveredbranches="" totalbranches="" content="        }" />
      <LineAnalysis line="102" visits="9" coverage="Covered" coveredbranches="" totalbranches="" content="    }" />
      <LineAnalysis line="103" visits="-1" coverage="NotCoverable" coveredbranches="" totalbranches="" content="" />
      <LineAnalysis line="104" visits="-1" coverage="NotCoverable" coveredbranches="" totalbranches="" content="    private static void AppendHigherLevels(StringBuilder sb, JsonElement root)" />
      <LineAnalysis line="105" visits="9" coverage="Covered" coveredbranches="" totalbranches="" content="    {" />
      <LineAnalysis line="106" visits="9" coverage="Covered" coveredbranches="" totalbranches="" content="        var higherLevel = GetString(root, &quot;higher_level&quot;);" />
      <LineAnalysis line="107" visits="9" coverage="Covered" coveredbranches="2" totalbranches="2" content="        if (!string.IsNullOrEmpty(higherLevel))" />
      <LineAnalysis line="108" visits="1" coverage="Covered" coveredbranches="" totalbranches="" content="        {" />
      <LineAnalysis line="109" visits="1" coverage="Covered" coveredbranches="" totalbranches="" content="            sb.AppendLine(&quot;## At Higher Levels&quot;);" />
      <LineAnalysis line="110" visits="1" coverage="Covered" coveredbranches="" totalbranches="" content="            sb.AppendLine(higherLevel);" />
      <LineAnalysis line="111" visits="1" coverage="Covered" coveredbranches="" totalbranches="" content="        }" />
      <LineAnalysis line="112" visits="9" coverage="Covered" coveredbranches="" totalbranches="" content="    }" />
      <LineAnalysis line="113" visits="-1" coverage="NotCoverable" coveredbranches="" totalbranches="" content="}" />
    </File>
  </Files>
</CoverageReport>